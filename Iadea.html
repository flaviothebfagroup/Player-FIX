<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>IADEA Troubleshooting</title>
  <style>
:root {
  --main: #F7941D;
  --main-light: #fde6c3;
  --radius: 22px;
  --shadow: 0 2px 32px 0 #0001, 0 0.5px 1px #00000008;
  --progress-height: 9px;
  --font-base: 19px;
  --font-lg: 2.25rem;
  --font-md: 1.16rem;
  --btn-height: 56px;
  --container-width: 470px;
}

html, body {
  margin: 0; padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  font-size: var(--font-base);
  background: radial-gradient(ellipse at top left, #fef7f1 60%, #f8fafb 100%);
  min-height: 100vh;
  width: 100vw;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body { 
  min-height: 100vh; 
  width: 100vw;
  display: flex;
  align-items: flex-start; 
  justify-content: center;
  position: relative;
  flex-direction: column;
}

/* LOGO: Better mobile scaling */
.top-logo {
  width: 100vw;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  margin-top: 54px;
  margin-bottom: -48px;
  z-index: 40;
  pointer-events: none;
}

.top-logo img {
  width: 220px;
  max-width: 50vw;
  min-width: 110px;
  display: block;
  border-radius: 17px;
  box-shadow: none;
  background: none;
  pointer-events: auto;
  transition: all 0.3s ease;
}

@media (max-width: 700px) {
  .top-logo { 
    margin-top: max(20px, 4vh); 
    margin-bottom: -30px;
  }
  .top-logo img { 
    width: min(60vw, 280px); 
    max-width: 280px; 
    min-width: 120px;
  }
}

/* Main card - Better mobile layout */
.container {
  background: #fff;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  max-width: var(--container-width);
  width: 100%;
  margin: 90px auto 0 auto;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 570px;
  max-height: 94vh;
  position: relative;
  z-index: 2;
  overflow: visible;
  transition: all 0.3s ease;
}

@media (max-width: 700px) {
  .container {
    max-width: 95vw;
    margin: max(120px, 18vh) auto 0 auto;
    min-height: max(500px, 70vh);
    max-height: 85vh;
    box-shadow: 0 4px 20px rgba(247, 148, 29, 0.15);
    border-radius: 18px;
  }
}

@media (max-width: 480px) {
  .container {
    max-width: 96vw;
    margin: max(100px, 16vh) auto 0 auto;
    min-height: max(450px, 65vh);
    border-radius: 16px;
  }
}

/* Card content - Better scrolling */
.card-inner {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  flex: 1 1 auto;
  padding: 60px 32px 0 32px;
  box-sizing: border-box;
  position: relative;
  min-height: 380px;
  max-height: 63vh;
  overflow-y: auto;
  overflow-x: hidden;
  transition: padding 0.3s ease;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}

@media (max-width: 700px) {
  .card-inner {
    padding: max(40px, 8vh) 6vw 0 6vw;
    min-height: 300px;
    max-height: 55vh;
  }
}

@media (max-width: 480px) {
  .card-inner {
    padding: max(30px, 6vh) 5vw 0 5vw;
    min-height: 280px;
    max-height: 50vh;
  }
}

.heading {
  font-size: var(--font-lg);
  font-weight: 700;
  margin: 0 0 44px 0;
  text-align: left; 
  color: #20232a;
  letter-spacing: 0.01em;
  line-height: 1.08;
}

@media (max-width: 700px) {
  .heading {
    font-size: max(1.8rem, 6vw);
    margin: 0 0 max(30px, 5vh) 0;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .heading {
    font-size: max(1.6rem, 7vw);
    margin: 0 0 max(25px, 4vh) 0;
  }
}

#main-content {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: 100%;
  box-sizing: border-box;
}

.intro-text {
  font-size: 1.15em;
  color: #3c3c3c;
  text-align: center;
  line-height: 1.54;
  margin: 0 0 34px 0;
  padding: 22px 0 0 0;
}

@media (max-width: 700px) {
  .intro-text {
    font-size: max(1.1em, 4.5vw);
    margin: 0 0 max(25px, 4vh) 0;
    padding: max(15px, 3vh) 0 0 0;
  }
}

/* Image improvements */
.image-placeholder {
  width: 100%;
  max-width: 500px;
  margin: 36px auto 38px auto;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 140px;
}

.image-placeholder img {
  width: 100%;
  max-width: 380px;
  min-width: 0;
  max-height: 240px;
  height: auto;
  border-radius: 0;
  object-fit: contain;
  display: block;
  background: none;
  border: none;
  margin: 0 auto;
  box-shadow: none;
  transition: all 0.3s ease;
}

@media (max-width: 700px) {
  .image-placeholder {
    max-width: 90vw;
    margin: max(20px, 4vh) auto max(25px, 5vh) auto;
    min-height: max(120px, 15vh);
  }
  .image-placeholder img {
    max-width: 85vw;
    max-height: max(180px, 20vh);
  }
}

@media (max-width: 480px) {
  .image-placeholder {
    margin: max(15px, 3vh) auto max(20px, 4vh) auto;
    min-height: max(100px, 12vh);
  }
  .image-placeholder img {
    max-width: 80vw;
    max-height: max(160px, 18vh);
  }
}

.step-top {
  text-align: center;
  font-size: 1.19em;
  margin: 0 0 32px 0;
  color: #222;
  font-weight: 500;
  line-height: 1.36;
}

@media (max-width: 700px) {
  .step-top {
    font-size: max(1.1em, 4.8vw);
    margin: 0 0 max(20px, 4vh) 0;
    line-height: 1.4;
  }
}

.step-bottom {
  text-align: center;
  font-size: 1.12em;
  color: #333;
  font-weight: 500;
  line-height: 1.36;
  margin: 24px 0 32px 0;
}

@media (max-width: 700px) {
  .step-bottom {
    font-size: max(1.05em, 4.5vw);
    margin: max(15px, 3vh) 0 max(20px, 4vh) 0;
    line-height: 1.4;
  }
}

/* Better button area */
.buttons-area {
  width: 100%;
  padding: 0 18px 70px 18px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-end;
  flex-shrink: 0;
  margin-top: auto;
}

@media (max-width: 700px) {
  .buttons-area { 
    padding: 0 4vw max(60px, 12vh) 4vw; 
  }
}

@media (max-width: 480px) {
  .buttons-area { 
    padding: 0 3vw max(50px, 10vh) 3vw; 
  }
}

.buttons {
  display: flex; 
  flex-direction: column; 
  gap: 22px;
  justify-content: center; 
  align-items: stretch;
  width: 100%;
  max-width: 460px;
  margin: 0 auto;
}

@media (max-width: 700px) {
  .buttons {
    gap: max(18px, 3vh);
  }
}

.buttons button {
  width: 100%;
  min-width: 0;
  height: var(--btn-height);
  padding: 0 10px;
  border: none; 
  border-radius: 15px;
  font-size: var(--font-md);
  font-weight: 600;
  cursor: pointer;
  background: var(--main); 
  color: #fff;
  box-shadow: 0 2px 8px #f7941d16;
  transition: all 0.2s ease;
  outline: none;
  letter-spacing: 0.01em;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

@media (max-width: 700px) {
  .buttons button {
    height: max(50px, 8vh);
    font-size: max(1.1rem, 4.5vw);
    border-radius: 12px;
    padding: 0 4vw;
  }
}

@media (max-width: 480px) {
  .buttons button {
    height: max(48px, 7vh);
    font-size: max(1rem, 4.2vw);
    border-radius: 10px;
  }
}

.buttons .btn-secondary {
  background: #f3f3f3; 
  color: #333; 
  border: 1px solid #ddd;
}

.buttons .btn-secondary:hover { 
  background: #eaeaea; 
}

.buttons .btn-primary:hover { 
  background: #e68317;
}

.buttons .btn-primary:active {
  transform: translateY(1px);
  box-shadow: 0 1px 4px #f7941d16;
}

/* Progress improvements */
.progress-page {
  width: 100vw;
  position: fixed;
  left: 0;
  bottom: 54px;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  pointer-events: none;
  transition: all 0.28s ease;
}

@media (max-width: 700px) {
  .progress-page {
    bottom: max(40px, 8vh);
  }
}

.progress-page-number {
  font-size: 1.11em;
  font-weight: 600;
  color: #f7941d;
  background: rgba(255, 253, 250, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 999px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  padding: 8px 22px;
  letter-spacing: 0.02em;
  margin: 0 0 10px 0;
  pointer-events: none;
  user-select: none;
}

@media (max-width: 700px) {
  .progress-page-number {
    font-size: max(1rem, 4.2vw);
    padding: max(6px, 1vh) max(18px, 4vw);
  }
}

.progress-bar {
  width: 100vw;
  left: 0;
  position: fixed;
  bottom: 0;
  z-index: 1;
  margin: 0;
  border-radius: 0;
  background: var(--main-light);
  height: var(--progress-height);
}

@media (max-width: 700px) {
  .progress-bar {
    height: max(8px, 1.5vh);
  }
}

.progress-bar-inner {
  height: 100%;
  background: var(--main);
  border-radius: 0;
  width: 0;
  transition: width 0.36s cubic-bezier(0.4, 1.6, 0.6, 1);
}

.progress-page.hide-progress {
  opacity: 0 !important;
  visibility: hidden !important;
  pointer-events: none;
}

/* Navigation buttons - Better mobile positioning */
.attached-btn, .attached-next-btn {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  z-index: 30;
  background: var(--main-light);
  color: var(--main);
  border-radius: 50%;
  border: none;
  box-shadow: 0 4px 16px rgba(247, 148, 29, 0.25);
  width: 50px; 
  height: 50px;
  font-size: 1.55em;
  cursor: pointer;
  outline: none;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  opacity: 0.97;
  transition: all 0.2s ease;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.attached-btn { 
  left: 50%; 
  margin-left: calc(-1 * (var(--container-width)/2) - 30px); 
}

.attached-next-btn { 
  right: 50%; 
  margin-right: calc(-1 * (var(--container-width)/2) - 30px); 
}

.attached-btn:active, .attached-next-btn:active {
  transform: translateY(-50%) scale(0.95);
  box-shadow: 0 2px 8px rgba(247, 148, 29, 0.3);
}

@media (max-width: 700px) {
  .attached-btn {
    left: 3vw;
    margin-left: 0;
    width: max(44px, 7vh); 
    height: max(44px, 7vh); 
    font-size: max(1.17em, 4vw);
  }
  .attached-next-btn {
    right: 3vw;
    margin-right: 0;
    width: max(44px, 7vh); 
    height: max(44px, 7vh); 
    font-size: max(1.17em, 4vw);
  }
}

@media (max-width: 480px) {
  .attached-btn {
    left: 2vw;
    width: max(40px, 6vh); 
    height: max(40px, 6vh); 
    font-size: max(1.1em, 3.8vw);
  }
  .attached-next-btn {
    right: 2vw;
    width: max(40px, 6vh); 
    height: max(40px, 6vh); 
    font-size: max(1.1em, 3.8vw);
  }
}

/* Safe area for modern phones */
@supports (padding: max(0px, env(safe-area-inset-bottom))) {
  .buttons-area {
    padding-bottom: max(70px, calc(env(safe-area-inset-bottom) + 40px));
  }
  
  @media (max-width: 700px) {
    .buttons-area {
      padding-bottom: max(60px, calc(env(safe-area-inset-bottom) + 30px));
    }
  }
  
  .progress-page {
    bottom: max(54px, calc(env(safe-area-inset-bottom) + 30px));
  }
  
  @media (max-width: 700px) {
    .progress-page {
      bottom: max(40px, calc(env(safe-area-inset-bottom) + 20px));
    }
  }
}

/* Prevent zoom on input focus */
@media (max-width: 700px) {
  input, select, textarea {
    font-size: 16px !important;
  }
}

/* Smooth animations */
* {
  -webkit-tap-highlight-color: transparent;
}

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
  </style>
</head>
<body>
  <!-- Logo -->
  <div class="top-logo">
    <img src="https://i.imgur.com/fDv6d8s.png" alt="BFA Digital Logo" onerror="this.style.display='none'">
  </div>
  
  <!-- Navigation buttons -->
  <button class="attached-btn" id="attached-btn" style="display:none;" aria-label="Back">&larr;</button>
  <button class="attached-next-btn" id="attached-next-btn" style="display:none;" aria-label="Next">&rarr;</button>
  
  <!-- Main card -->
  <div class="container">
    <div class="card-inner" id="card-inner">
      <h1 class="heading">IADEA Troubleshoot</h1>
      <div id="main-content"></div>
    </div>
    <div class="buttons-area" id="buttons-area"></div>
  </div>
  
  <div id="progress-page" class="progress-page"></div>
  <div class="progress-bar"><div class="progress-bar-inner" id="progress-bar-inner"></div></div>
  
  <script>
    const steps = [
      { intro: true, 
        text: `
          <div class="image-placeholder" style="margin-bottom:0;">
            <img src="https://i.imgur.com/PwnioKZ.gif" alt="IADEA Player">
          </div>
          <div class="intro-text">
            Welcome to the IADEA Player Troubleshooting Guide.<br>
            This step-by-step tool will help you quickly resolve the most common issues.
          </div>
        `,
        buttons: [{ text: "Start Troubleshooting", next: 1 }]
      },
      { 
        topText: "Was the internet changed?",
        image: 'https://media.lordicon.com/icons/wired/outline/745-wifi-connection.gif',
        bottomText: "",
        buttons: [{ text: 'Yes', next: 9 }, { text: 'No', next: 2 }] 
      },
      { 
        topText: "Is the TV turned on?",
        image: 'https://media.lordicon.com/icons/wired/outline/1734-tv-turn-on.gif',
        bottomText: "",
        buttons: [{ text: 'Yes', next: 3 }, { text: 'No', next: 9 }] 
      },
      { 
        topText: "Is the IADEA player powered and has a green LED?",
        image: 'https://i.imgur.com/J13LMrc.gif',
        bottomText: "",
        buttons: [{ text: 'Yes', next: 4 }, { text: 'No', next: 9 }] 
      },
      { 
        topText: "Unplug the IADEA player for 1 minute, then plug it back in.",
        image: 'https://i.imgur.com/Vb0pqwS.gif', 
        bottomText: "Did it fix the issue?",
        buttons: [{ text: 'Yes', next: 10 }, { text: 'No', next: 5 }] 
      },
      { 
        topText: "Is the HDMI cable connected properly?", 
        image: 'https://i.imgur.com/35gQgop.gif', 
        bottomText: "",
        buttons: [{ text: 'Yes', next: 6 }, { text: 'No', next: 9 }] 
      },
      { 
        topText: "Do you see any error message on screen?", 
        image: 'https://media.lordicon.com/icons/wired/outline/2592-fail.gif', 
        bottomText: "",
        buttons: [{ text: 'Yes', next: 7 }, { text: 'No', next: 8 }] 
      },
      { 
        topText: "Try restarting the TV.",
        image: 'https://media.lordicon.com/icons/wired/outline/2505-reset-text.gif', 
        bottomText: "Did that fix it?",
        buttons: [{ text: 'Yes', next: 10 }, { text: 'No', next: 8 }] 
      },
      { 
        topText: "Please wait 5 minutes to see if content appears.", 
        image: 'https://media.lordicon.com/icons/wired/outline/472-hourglass.gif', 
        bottomText: "",
        buttons: [{ text: 'It worked!', next: 10 }, { text: 'Still not working', next: 9 }] 
      },
      { 
        topText: "Contact support at <b>(647) 209-0519</b>.",
        image: 'https://media.lordicon.com/icons/wired/outline/682-male-customer-service.gif', 
        bottomText: "",
        buttons: [{ text: 'Restart', next: 0 }]
      },
      { 
        topText: "Great! Your system is now working.",
        image: 'https://media.lordicon.com/icons/wired/outline/1736-smart-tv-layout-interface.gif', 
        bottomText: "",
        buttons: [{ text: 'Restart', next: 0 }]
      }
    ];

    let current = 0, historyStack = [];
    const mainContent = document.getElementById('main-content');
    const buttonsArea = document.getElementById('buttons-area');
    const pbi = document.getElementById('progress-bar-inner');
    const backBtn = document.getElementById('attached-btn');
    const nextBtn = document.getElementById('attached-next-btn');
    const cardInner = document.getElementById('card-inner');
    const progressPage = document.getElementById('progress-page');
    const totalSteps = steps.length - 1;

    function updateNavButtons() {
      backBtn.style.display = (!steps[current].intro && current !== 0) ? "flex" : "none";
      nextBtn.style.display = (!steps[current].intro && current < steps.length - 1) ? "flex" : "none";
    }

    function render(i) {
      const step = steps[i];
      updateNavButtons();

      document.querySelector('.progress-bar').style.display = step.intro ? "none" : "block";

      if (step.intro) {
        mainContent.innerHTML = step.text;
        buttonsArea.innerHTML = `
          <div class="buttons">
            ${step.buttons.map(b => `<button class="btn-primary" onclick="go(${b.next})">${b.text}</button>`).join('')}
          </div>`;
      } else {
        mainContent.innerHTML = `
          ${step.topText ? `<div class="step-top">${step.topText}</div>` : ""}
          <div class="image-placeholder">${step.image ? `<img src="${step.image}" alt="">` : ''}</div>
          ${step.bottomText ? `<div class="step-bottom">${step.bottomText}</div>` : ""}
        `;
        buttonsArea.innerHTML = `
          <div class="buttons">
            ${step.buttons.map(b => `<button class="btn-primary" onclick="go(${b.next})">${b.text}</button>`).join('')}
          </div>`;
      }

      if (!step.intro) {
        const page = i;
        let progressStepNum = (page > 0 && page < steps.length) ? page : 1;
        progressPage.innerHTML = 
          `<span class="progress-page-number">Step ${progressStepNum} of ${totalSteps}</span>`;
        const pct = ((i-1) / (totalSteps-1)) * 100;
        pbi.style.width = pct + "%";
      } else {
        progressPage.innerHTML = "";
      }
      
      // Scroll to top of content area
      cardInner.scrollTop = 0;
      updateProgressVisibility();
    }

    function go(i) { 
      if (i >= 0 && i < steps.length) { 
        if(current !== i) historyStack.push(current); 
        current = i; 
        render(i); 
      } 
    }

    function back() { 
      if (historyStack.length) {
        current = historyStack.pop();
        render(current);
      }
    }

    function nextStep() {
      if (current < steps.length - 1) {
        historyStack.push(current);
        current += 1;
        render(current);
      }
    }

    // Touch event handling for better mobile experience
    let touchStartY = 0;
    let touchEndY = 0;

    cardInner.addEventListener('touchstart', function(e) {
      touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });

    cardInner.addEventListener('touchend', function(e) {
      touchEndY = e.changedTouches[0].screenY;
      handleSwipe();
    }, { passive: true });

    function handleSwipe() {
      const swipeThreshold = 50;
      const swipeDistance = touchStartY - touchEndY;
      
      // Only handle swipes if not scrolling content
      if (Math.abs(swipeDistance) > swipeThreshold && cardInner.scrollHeight <= cardInner.clientHeight) {
        if (swipeDistance > 0 && current < steps.length - 1) {
          // Swipe up - next step
          nextStep();
        } else if (swipeDistance < 0 && historyStack.length > 0) {
          // Swipe down - previous step
          back();
        }
      }
    }

    backBtn.onclick = () => back();
    nextBtn.onclick = () => nextStep();
    
    // Expose functions globally
    window.go = go; 
    window.back = back; 
    window.nextStep = nextStep;
    
    // Handle window resize
    window.addEventListener('resize', () => {
      updateNavButtons();
      updateProgressVisibility();
    });

    // Show/hide step number when scrolling
    function updateProgressVisibility() {
      if (!steps[current].intro && cardInner.scrollHeight > cardInner.clientHeight) {
        if (cardInner.scrollTop > 36) {
          progressPage.classList.add('hide-progress');
        } else {
          progressPage.classList.remove('hide-progress');
        }
      } else {
        progressPage.classList.remove('hide-progress');
      }
    }
    
    cardInner.addEventListener('scroll', updateProgressVisibility, { passive: true });

    // Initialize
    render(0);
  </script>
</body>
</html>
